> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [www.zhihu.com](https://www.zhihu.com/question/304500591)

> 本问题被收录至活动「十万个是什么」中。活动时间：11/29 - 12/14活动规则：大于 200 字的客观事实定义，…

![](https://picx.zhimg.com/v2-f6c1d3da978ed0dad5819b3ff83bd6cf_l.jpg?source=1def8aca)芝士圈留学​

**答主 Amelie，芝士圈留学行家，2017-08~2019-06 就读瑞典[乌普萨拉大学](https://www.zhihu.com/search?q=%E4%B9%8C%E6%99%AE%E8%90%A8%E6%8B%89%E5%A4%A7%E5%AD%A6&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D)统计学 Master 学位。**

* * *

@知识库

首先，解答什么是卡方分布就需要了解这个分布为什么叫 “卡方”。卡方，是音译自希腊字符 $\chi^2$\chi^2 。卡方分布是由 Karl Pearson 在 1900 年提出的。

接着，我们应该去了解一下它的**定义**。**[维基百科](https://www.zhihu.com/search?q=%E7%BB%B4%E5%9F%BA%E7%99%BE%E7%A7%91&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D)**上给出的定义如下：

$Z_1,...,Z_K$Z_1,...,Z_K 是独立、[标准正态分布](https://www.zhihu.com/search?q=%E6%A0%87%E5%87%86%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D)的随机变量，把他们的[平方和](https://www.zhihu.com/search?q=%E5%B9%B3%E6%96%B9%E5%92%8C&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D)计为 Q， $Q=\sum_{i=1}^{K}{Z_{i}^{2}}$Q=\sum_{i=1}^{K}{Z_{i}^{2}} 。

这个 Q 是服从自由度为 K 的卡方分布的。通常，也会被计为： $Q\sim\chi^{2}(k)$Q\sim\chi^{2}(k)

或者 $Q\sim\chi^{2}_{k}$Q\sim\chi^{2}_{k} 。卡方分布只有一个变量，就是 k。k 在这里要求是正整数，它代表了自由度。

之后，本科统计系的 “圣经”，**浙江大学第四版的《[概率论与数理统计](https://www.zhihu.com/search?q=%E6%A6%82%E7%8E%87%E8%AE%BA%E4%B8%8E%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D)》**中对于卡方分布的定义如下：

设 $X_1,...,X_n$X_1,...,X_n 是来自总体 N（0，1）的样本，则称统计量

$\chi^2=X_{1}^{2}+X_{2}^{2}+...+X_{n}^{2}$\chi^2=X_{1}^{2}+X_{2}^{2}+...+X_{n}^{2}

服从自由度为 n 的卡方分布，计为 $\chi\sim\chi^{2}(n)$\chi\sim\chi^{2}(n) 。自由度是指上述等式中包含的独立变量的个数。书中还贴心的给出了分布的密度函数：

$f(y)=\frac{1}{2^{\frac{n}{2}}\Gamma(\frac{n}{2})}y^{\frac{n}{2}-1}e^{-\frac{y}{2}} ,y>0$f(y)=\frac{1}{2^{\frac{n}{2}}\Gamma(\frac{n}{2})}y^{\frac{n}{2}-1}e^{-\frac{y}{2}} ,y>0

$f(y)=0, 其他$ f(y)=0, 其他

其中， $\Gamma(\frac{n}{2})$\Gamma(\frac{n}{2}) 是[伽马分布函数](https://www.zhihu.com/search?q=%E4%BC%BD%E9%A9%AC%E5%88%86%E5%B8%83%E5%87%BD%E6%95%B0&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D)。

嗯，上面的定义都有一些抽象，下面，统计小菜鸡准备用 R 语言，给大家用图片的形式，直观地去看看这个 “传说中” 的卡方分布到底是长什么样子的。

首先，根据上面的定义，我们来验证一下 $\chi^{2}_{1}$\chi^{2}_{1} ， $\chi^{2}_{2}$\chi^{2}_{2} ， $\chi^{2}_{3}$\chi^{2}_{3} 和 $\chi^{2}_{5}$\chi^{2}_{5} 的形状。因为这个只是取了有限个的样本（1000000），所以，只能说近似泊松分布。

![](https://picx.zhimg.com/v2-10b8582c655cb0b81fd69da6bbbc8988_r.jpg?source=1def8aca)

R 语言的代码我贴在了下面：

x1 = rnorm(1000000)

x2 = rnorm(1000000)

x3 = rnorm(1000000)

x4 = rnorm(1000000)

x5 = rnorm(1000000)

Q1 = x1^2

Q2 = x1^2 + x2^2

Q3 = x1^2 + x2^2 + x3^2

Q5 = x1^2 + x2^2 + x3^2 + x4^2 + x5^2

par(mfrow=c(1,1))

plot(density(Q1), xlim = c(0,6), ylim = c(0,0.6), col = 'blue', lwd = 1.5, main = 'chi-square', xlab = '', ylab='')

lines(density(Q2), col = 'black', lwd = 1.5)

lines(density(Q3), col='red', lwd = 1.5)

[lines(density](https://www.zhihu.com/search?q=lines%28density&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D)(Q5), col='green', lwd = 1.5)

legend('topright',c('df=1','df=2','df=3','df=5'),[fill=c](https://www.zhihu.com/search?q=fill%3Dc&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D)('blue','black','red','green'))

接着我们采用 1000 个样本量，用 R 语言的内嵌卡方分布函数呈现了五个卡方分布的样子，分别是 $\chi_{1}^{2}$\chi_{1}^{2} ， $\chi^{2}_{2}$\chi^{2}_{2} ， $\chi^{2}_{3}$\chi^{2}_{3} , $\chi^{2}_{5}$\chi^{2}_{5} 和 $\chi_{10}^{2}$\chi_{10}^{2}

![](https://picx.zhimg.com/v2-a6211edcf5fc9762a9625cadc20075a8_r.jpg?source=1def8aca)

可以看出，泊松分布不像正态分布，它并没有对称这一特征，而且根据自由度的不同，长相也很 “随意”。

得到这幅图的代码如下：

library(dplyr)

library(ggplot2)

library(tidyr)

data.frame(chisq = 0:1000 / 100) %>%

mutate(df_01 = [dchisq(x = chisq](https://www.zhihu.com/search?q=dchisq%28x%20%3D%20chisq&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D), df = 1),

df_02 = dchisq(x = chisq, df = 2),

df_03 = dchisq(x = chisq, df = 3),

[df_05 = dchisq(x = chisq](https://www.zhihu.com/search?q=df_05%20%3D%20dchisq%28x%20%3D%20chisq&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D), df = 5),

[df_10 = dchisq(x = chisq](https://www.zhihu.com/search?q=df_10%20%3D%20dchisq%28x%20%3D%20chisq&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D), df = 10)) %>%

gather(key = "df", value = "density", -chisq) %>%

ggplot() +

[geom_line](https://www.zhihu.com/search?q=geom_line&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D)(aes(x = chisq, y = density, color = df)) +

labs(title = "Chi-Square at Various Degrees of Freedom",

x = "Chi-square",

y = "Density") +

coord_cartesian(ylim = c(0, 0.5))

在写这个问题的时候，看到了 @普通人在 “[卡方分布怎么理解？](https://www.zhihu.com/question/20358827)” 的回答，他的回答很有趣，用掷色子的例子非常形象的讲述了泊松分布是怎么诞生的，但是可能后面的 simulation（拟合）部分有些深奥，如果有会 python 的同学看了真的会受益匪浅。

了解完了定义接着就是泊松分布的性质，浙大的《[概率论和数理统计](https://www.zhihu.com/search?q=%E6%A6%82%E7%8E%87%E8%AE%BA%E5%92%8C%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D)》书上主要讲了泊松分布的三个性质。

（1）、可加性（如果两个卡方分布相互独立，则它们相加的分布是两者自由度之和的泊松分布）

（2）、告诉了我们泊松分布的自由度和[方差](https://www.zhihu.com/search?q=%E6%96%B9%E5%B7%AE&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D)

$E(\chi^{2})=n, D(\chi^{2})=2n$E(\chi^{2})=n, D(\chi^{2})=2n

（3）、分布位点

![](https://picx.zhimg.com/v2-bd3d0972c5f980431a627ba14a47db0b_r.jpg?source=1def8aca)

不仅如此，卡方分布还是 [t 分布](https://www.zhihu.com/search?q=t%E5%88%86%E5%B8%83&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D)和 F 分布定义的重要组成部分，而 t 和 F 分布在[方差检验](https://www.zhihu.com/search?q=%E6%96%B9%E5%B7%AE%E6%A3%80%E9%AA%8C&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D)和回归分析中又占有重要的地位。

除了上述性质以外，在 George 和 Roger 在 statistical inference（统计推断）这本书里还提到，卡方分布也是指数分布簇的一员。关于[卡方分布簇](https://www.zhihu.com/search?q=%E5%8D%A1%E6%96%B9%E5%88%86%E5%B8%83%E7%B0%87&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D)，统计推断这本书里有着一下的定义：

$f(x|\theta)=h(x)c(\theta)exp(\sum_{i=1}^{k}{w_{i}(\theta)t_{i}(x)})$f(x|\theta)=h(x)c(\theta)exp(\sum_{i=1}^{k}{w_{i}(\theta)t_{i}(x)})

如果一个分布的密度函数能拆分成上述形式，则其属于[指数分布簇](https://www.zhihu.com/search?q=%E6%8C%87%E6%95%B0%E5%88%86%E5%B8%83%E7%B0%87&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D)。

这里我们变形一下，把[泊松分布](https://www.zhihu.com/search?q=%E6%B3%8A%E6%9D%BE%E5%88%86%E5%B8%83&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D)的密度函数变个形式：

$f(y|n)=1\times \frac{1}{2^{\frac{n}{2}}\Gamma(\frac{n}{2})} \times exp((\frac{n}{2}-1)logy-\frac{y}{2})$f(y|n)=1\times \frac{1}{2^{\frac{n}{2}}\Gamma(\frac{n}{2})} \times exp((\frac{n}{2}-1)logy-\frac{y}{2})

很容易看出基本符合上述[指数族分布模型](https://www.zhihu.com/search?q=%E6%8C%87%E6%95%B0%E6%97%8F%E5%88%86%E5%B8%83%E6%A8%A1%E5%9E%8B&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D)。为什么在这里要提指数分布族呢？

因为指数分布族中的分布以及[指数分布族](https://www.zhihu.com/search?q=%E6%8C%87%E6%95%B0%E5%88%86%E5%B8%83%E6%97%8F&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D)的性质具有族群性，就是说这几个分布之间是具有统一的规律和特性的。除此之外，指数分布族还具有很多优良的性质，这些性质在[贝叶斯统计](https://www.zhihu.com/search?q=%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%BB%9F%E8%AE%A1&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D)中也是非常重要的性质。指数分布族在机器学习 (machine learning) 模型的参数假设以及参数推理中有很广泛的运用。

如果要说卡方分布最广泛的应用在何处，我们就不得不提卡方检验。卡方检验归属于[非参数检验](https://www.zhihu.com/search?q=%E9%9D%9E%E5%8F%82%E6%95%B0%E6%A3%80%E9%AA%8C&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D)部分，主要应用于比较两个及两个以上样本率 (构成比）以及两个[分类变量](https://www.zhihu.com/search?q=%E5%88%86%E7%B1%BB%E5%8F%98%E9%87%8F&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A729785501%7D)的关联性分析这两方面。

卡方检验在分类资料统计推断中的应用，包括：两个率或两个构成比比较的卡方检验；多个率或多个构成比比较的卡方检验以及分类资料的相关分析等。

![](https://pic1.zhimg.com/v2-10d3120510d04d5b2021c97c50264f5f_r.jpg?source=1def8aca)

![](https://pic1.zhimg.com/v2-7d634dc7b40ea3c7b9ecae3ed986b44d_l.jpg?source=1def8aca)SPSSAU​

*   **[卡方分布](https://www.zhihu.com/search?q=%E5%8D%A1%E6%96%B9%E5%88%86%E5%B8%83&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A2799197095%7D)定义**
*   **卡方分布的性质**
*   **卡方分布的[数字特征](https://www.zhihu.com/search?q=%E6%95%B0%E5%AD%97%E7%89%B9%E5%BE%81&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A2799197095%7D)**
*   **拓展 [SPSSAU](https://link.zhihu.com/?target=https%3A//www.spssau.com/%3F100001000) 卡方检验**

卡方分布定义
------

设 $X_{1}, X_{2}, \cdots, X_{n}$ X_{1}, X_{2}, \cdots, X_{n} 是 i.i.d.r.v ([独立同分布随机变量](https://www.zhihu.com/search?q=%E7%8B%AC%E7%AB%8B%E5%90%8C%E5%88%86%E5%B8%83%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A2799197095%7D)), 同时它们又同分布于 N(0,1) , 在此意义上, 称变量 $X=\sum_{i=1}^{n} X_{i}{ }^{2} \sim \chi^{2}(n)\left(n \in Z^{*}\right)$ X=\sum_{i=1}^{n} X_{i}{ }^{2} \sim \chi^{2}(n)\left(n \in Z^{*}\right)

卡方分布的性质
-------

$\chi^{2}$ \chi^{2} 分布具有[可加性](https://www.zhihu.com/search?q=%E5%8F%AF%E5%8A%A0%E6%80%A7&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A2799197095%7D)

$\chi^{2}$ \chi^{2} 分布具有一致渐进正态性

卡方分布的数字特征
---------

$E(X)=n(x \in R)$E(X)=n(x \in R)

$D(X)=E\left(X^{2}\right)-E^{2}(X)=n(n+2)-n^{2}=2 n(x \in R)$D(X)=E\left(X^{2}\right)-E^{2}(X)=n(n+2)-n^{2}=2 n(x \in R)

拓展 [SPSSAU](https://link.zhihu.com/?target=https%3A//www.spssau.com/%3F100001000) 卡方检验
--------------------------------------------------------------------------------------

卡方检验是用于分析定类数据与定类数据之间的关系情况。例如想要研究性别和是否购买产品之间的关系。可以使用卡方检验。

路径【通用方法】→【交叉（卡方）】

![](https://picx.zhimg.com/50/v2-1da2f252b0d46fa4898327297695f935_720w.jpg?source=1def8aca)

结果如下：

![](https://pic1.zhimg.com/v2-eeb8f1dd35b34762f00f77f1b62111e2_r.jpg?source=1def8aca)![](https://picx.zhimg.com/v2-d4212f0dbdce0478027a0e438279221c_r.jpg?source=1def8aca)[SPSSAU](https://link.zhihu.com/?target=https%3A//www.spssau.com/%3F100001000)![](https://pica.zhimg.com/v2-950b1d113b5440f75270cf64727cafba_l.jpg?source=1def8aca) 今儿个学习​

一、卡方分布
------

![](https://picx.zhimg.com/v2-d915e6d557c7952d00bcd002e64855ac_r.jpg?source=1def8aca)

### **(1) 卡方分布定义**

**若干个相互独立且服从[标准正态分布](https://www.zhihu.com/search?q=%E6%A0%87%E5%87%86%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A3089150479%7D)的随机变量平方之和所服从的分布就称为卡方分布。**他的分布完全由自由度确定。数学表达如下：如果相互独立的 v 个随机变量 $X_{1},X_{2},\cdots,X_{v}$X_{1},X_{2},\cdots,X_{v} 分别服从标准正态分布 N(0,1)，则 $X_{1}^{2}+X_{2}^{2}+\cdots+X_{v}^{2}$X_{1}^{2}+X_{2}^{2}+\cdots+X_{v}^{2} 服从自由度为 v 的 $\chi^2$\chi^2 分布。

### (2) 卡方分布是一种[连续型分布](https://www.zhihu.com/search?q=%E8%BF%9E%E7%BB%AD%E5%9E%8B%E5%88%86%E5%B8%83&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A3089150479%7D)

$\chi^2$\chi^2 分布只有一个参数，即自由度 v。按 $\chi^2$\chi^2 分布的[密度函数](https://www.zhihu.com/search?q=%E5%AF%86%E5%BA%A6%E5%87%BD%E6%95%B0&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A3089150479%7D) f( $\chi^2$\chi^2 ) 可给出自由度 v=1,2,3,… 的一簇 $\chi^2$\chi^2 分布曲线（如下图）。由 $\chi^2$\chi^2 分布曲线可见， $\chi^2$\chi^2 分布的形状依赖于自由度 v 的大小：①当自由度 v≤2 时，曲线呈 L 形；②随着 v 的增加，曲线逐渐趋于对称；**③当自由度 v→∞时， $\chi^2$\chi^2 分布趋近正态分布。**

![](https://picx.zhimg.com/v2-56b32954b2b2697c68767f9e2d7fdbcf_r.jpg?source=1def8aca)

### (3) 卡方分布的可加性

卡方分布的一个基本性质是他的可加性：如果两个独立的随机变量 X1 和 X2 分别服从自由度 v1 和 v2 的卡方分布，那么它们的和 $X_1+X_2$X_1+X_2 服从自由度 $(v_1+v_2)$(v_1+v_2) 的卡方分布，即$(X_1+X_2)\sim\chi_{v_1+v_2}^{2}$(X_1+X_2)\sim\chi_{v_1+v_2}^{2} 。  

### **(4) 卡方分布的界值——卡方值**

当自由度 v 确定后， $\chi^2$\chi^2 分布曲线下右侧尾部的面积为α时，横轴上相应的 $\chi^2$\chi^2 值——即 $\chi^2$\chi^2 分布的界值。 $\chi^2$\chi^2 值愈大，p 值愈小；反之， $\chi^2$\chi^2 值愈小，p 值愈大。 **卡方检验时，先计算检验统计量** $\chi^2$\chi^2 **值，然后按自由度 v 查** $\chi^2$\chi^2 **界值表，确定 p 值。 当 p＜α(通常为 0.05) 时，拒绝原假设，接受[备择假设](https://www.zhihu.com/search?q=%E5%A4%87%E6%8B%A9%E5%81%87%E8%AE%BE&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A3089150479%7D)，可认为两组数据之间的差异具有统计学意义；否则不拒绝原假设。**

![](https://pica.zhimg.com/v2-c5ce2cb876ba90648e094f33b52c1024_r.jpg?source=1def8aca)

### **(5) 卡方值计算公式**

当文献中出现卡方检验时，如果没有特别提及卡方检验的类型，通常是指 **pearson** $\chi^2$\chi^2 **检验**，其计算公式如下：

$\chi^{2}=\sum{\frac{(O-E)^{2}}{E}}$\chi^{2}=\sum{\frac{(O-E)^{2}}{E}}

上式中 O 表示观察频数，E 表示[期望频数](https://www.zhihu.com/search?q=%E6%9C%9F%E6%9C%9B%E9%A2%91%E6%95%B0&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A3089150479%7D)，∑为[求和符号](https://www.zhihu.com/search?q=%E6%B1%82%E5%92%8C%E7%AC%A6%E5%8F%B7&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A3089150479%7D)； $\chi^{2}$\chi^{2} 值近似服从自由度为 v 的 $\chi^{2}$\chi^{2} 分布。

二、卡方检验
------

卡方检验用于分析[定类数据](https://www.zhihu.com/search?q=%E5%AE%9A%E7%B1%BB%E6%95%B0%E6%8D%AE&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A3089150479%7D)与定类数据之间的差异情况。例如分析中医治疗中对不同穴位针刺效果的治疗情况。

### (1) 软件操作

使用 [SPSSAU](https://link.zhihu.com/?target=https%3A//spssau.com/%3F100009000) 进行卡方检验分析操作如下：

![](https://picx.zhimg.com/v2-d52321f70e717a857f7199860bd0cece_r.jpg?source=1def8aca)

### (2) 卡方检验分析结果

SPSSAU 输出卡方检验分析结果如下：

![](https://picx.zhimg.com/v2-a267ae4af46c578f55f39f1daf8d2144_r.jpg?source=1def8aca)

从上表可以看出，**卡方值为 32.7523，对应 p 值 = 0.000<0.05，按α=0.05 的水平，拒绝原假设，接受备择假设，即可以认为三种穴位针刺效果的差异有统计学意义。**进而可以通过对比选择百分比（括号内值）进行比较，例如后溪穴中，未愈人数占比 18.367%，治愈人数占比 81.633%。

更多阅读推荐：

[SPSSAU：干货！一文汇总卡方检验分析步骤](https://zhuanlan.zhihu.com/p/472427686)[SPSSAU：别错过，卡方检验实用总结！](https://zhuanlan.zhihu.com/p/179192306)

参考文献：

_[1] 颜红, 徐勇勇. [医学统计学](https://www.zhihu.com/search?q=%E5%8C%BB%E5%AD%A6%E7%BB%9F%E8%AE%A1%E5%AD%A6&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A3089150479%7D). 第 3 版 [M]. 人民卫生出版社, 2015_

![](https://picx.zhimg.com/v2-d16d1bc62675bbc2c1571315cc463743_l.jpg?source=1def8aca) 周老师

![](https://pica.zhimg.com/v2-1ef6b02ed1fd6f3912d8bc8e3861161f_r.jpg?source=1def8aca)

[卡方分布](https://www.zhihu.com/search?q=%E5%8D%A1%E6%96%B9%E5%88%86%E5%B8%83&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A2797782515%7D)说明
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

设 $X_{1}, X_{2}, \cdots, X_{n}$X_{1}, X_{2}, \cdots, X_{n} 是[独立同分布](https://www.zhihu.com/search?q=%E7%8B%AC%E7%AB%8B%E5%90%8C%E5%88%86%E5%B8%83&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A2797782515%7D)随机变量, 同时它们又同分布于[标准正态分布](https://www.zhihu.com/search?q=%E6%A0%87%E5%87%86%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A2797782515%7D), 则称变量 $X=\sum_{i=1}^{n} X_{i}{ }^{2} \sim \chi^{2}(n)\left(n \in Z^{*}\right)$ X=\sum_{i=1}^{n} X_{i}{ }^{2} \sim \chi^{2}(n)\left(n \in Z^{*}\right) 。

卡方分布特征
------

不同的自由度决定不同的卡方分布，自由度越小，分布越偏斜。

$\chi^{2}$ \chi^{2} 分布的均数为自由度 n（如果自由度为 n）

$\chi^{2}$ \chi^{2} 分布的[方差](https://www.zhihu.com/search?q=%E6%96%B9%E5%B7%AE&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A2797782515%7D)为 2 倍自由度 2n

若 $\chi^{2}\left(n_{1}\right), \chi^{2}\left(n_{2}\right)$ \chi^{2}\left(n_{1}\right), \chi^{2}\left(n_{2}\right) 互相独立，则: $\chi^{2}\left(n_{1}\right)+\chi^{2}\left(n_{2}\right)$\chi^{2}\left(n_{1}\right)+\chi^{2}\left(n_{2}\right) 服从 $\chi^{2}$ \chi^{2} 分布，自由度为 $n_{1}+n_{2}$n_{1}+n_{2}；

卡方分布用途
------

*   [拟合优度检验](https://www.zhihu.com/search?q=%E6%8B%9F%E5%90%88%E4%BC%98%E5%BA%A6%E6%A3%80%E9%AA%8C&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A2797782515%7D)

例如：总共收集 100 份数据，其中男性为 32 个，女性为 68 个；在[收集数据](https://www.zhihu.com/search?q=%E6%94%B6%E9%9B%86%E6%95%B0%E6%8D%AE&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A2797782515%7D)之前预期男女比例应该是 3:7 (30% 为男性，70% 为女性)，那么预期的比例是否与实际的比例有着明显的差异性呢？类似这类希望研究数据的实际比例与预期比例是否一致。可以使用拟合优度进行查看。

*   检验变量之间的相关性

数据为定类和定类变量。

卡方检验说明
------

卡方检验是以 $\chi^{2}$\chi^{2} 分布为基础的一种常用的[假设检验](https://www.zhihu.com/search?q=%E5%81%87%E8%AE%BE%E6%A3%80%E9%AA%8C&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A2797782515%7D)方法，他的无效假设 H0 是：观察频数与[期望频数](https://www.zhihu.com/search?q=%E6%9C%9F%E6%9C%9B%E9%A2%91%E6%95%B0&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A2797782515%7D)没有差别。卡方检验是研究定类数据与定类数据之间的关系，可以使用 SPSSAU 进行分析。

![](https://pic1.zhimg.com/v2-38ccb0fbc3d6126faa3b6fad2ee383fc_r.jpg?source=1def8aca)

**[SPSSAU](https://link.zhihu.com/?target=https%3A//www.spssau.com/%3F100008000)** 智能分析：

![](https://picx.zhimg.com/v2-4a541b27821805d3e9b63b102c3cd4a4_r.jpg?source=1def8aca)

* * *

更多资料请参考 **[SPSSAU](https://link.zhihu.com/?target=https%3A//www.spssau.com/%3F100008000)** 官网：

[SPSSAU](https://link.zhihu.com/?target=https%3A//www.spssau.com/%3F100008000)

![](https://picx.zhimg.com/v2-a603936c41cdf259c773fec48967b10f_l.jpg?source=1def8aca)Self-control

[卡方分布](https://www.zhihu.com/search?q=%E5%8D%A1%E6%96%B9%E5%88%86%E5%B8%83&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A3202432439%7D)（Chi-Square Distribution）是一种[概率分布](https://www.zhihu.com/search?q=%E6%A6%82%E7%8E%87%E5%88%86%E5%B8%83&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A3202432439%7D)，通常用于统计学和假设检验中。它的名称来源于希腊字母 "χ²"（读作 "chi-squared"），代表了这个分布在数学中的符号表示。

卡方分布具有以下主要特征：

1.  **自由度（Degrees of Freedom）：** 卡方分布的形状和性质由自由度参数来决定，通常表示为 "ν"（希腊字母小写的 nu）。自由度是一个[正整数](https://www.zhihu.com/search?q=%E6%AD%A3%E6%95%B4%E6%95%B0&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A3202432439%7D)，决定了分布的特定形状。卡方分布的自由度决定了它的[概率密度函数](https://www.zhihu.com/search?q=%E6%A6%82%E7%8E%87%E5%AF%86%E5%BA%A6%E5%87%BD%E6%95%B0&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A3202432439%7D)和性质。
2.  **概率密度函数（Probability Density Function，PDF）：** 卡方分布的概率密度函数描述了[随机变量](https://www.zhihu.com/search?q=%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A3202432439%7D)服从卡方分布的概率分布。对于不同的自由度，卡方分布的形状会有所不同。通常，卡方分布的 PDF 是[正偏斜](https://www.zhihu.com/search?q=%E6%AD%A3%E5%81%8F%E6%96%9C&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A3202432439%7D)（right-skewed）的，且取非负值。
3.  **应用领域：** 卡方分布在统计学中广泛用于各种假设检验，特别是用于比较观察值和期望值之间的差异，例如[卡方检验](https://www.zhihu.com/search?q=%E5%8D%A1%E6%96%B9%E6%A3%80%E9%AA%8C&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A3202432439%7D)（Chi-Square Test）。它还常用于估计总体方差、构建置信区间以及在[回归分析](https://www.zhihu.com/search?q=%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A3202432439%7D)中[评估模型](https://www.zhihu.com/search?q=%E8%AF%84%E4%BC%B0%E6%A8%A1%E5%9E%8B&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A3202432439%7D)的拟合程度。
4.  **和正态分布的关系：** 当自由度足够大时（通常大于 30），卡方分布可以近似为正态分布。这个性质在一些[统计分析](https://www.zhihu.com/search?q=%E7%BB%9F%E8%AE%A1%E5%88%86%E6%9E%90&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A3202432439%7D)中非常有用，因为它使得可以使用正态分布的性质来处理卡方分布的问题。

卡方分布用于分析和推断各种类型的数据，尤其是在[假设检验](https://www.zhihu.com/search?q=%E5%81%87%E8%AE%BE%E6%A3%80%E9%AA%8C&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A3202432439%7D)和方差分析等领域中。不同自由度的卡方分布具有不同的形状，因此在具体应用时需要考虑自由度参数的选择。